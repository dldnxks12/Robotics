function dydt = two_link(t, y)

global L1 L2 dth1 dth2 g lz1 lz2 m1 m2 r1 r2 tau1 tau2 th1 th2

th1 = y(1);
dth1 = y(2);
th2 = y(3);
dth2 = y(4);

dydt = [dth1;((-tau2+g.*m2.*r2.*cos(th1+th2)+L1.*dth1.^2.*m2.*r2.*sin(th2)).*(lz2-L2.^2.*m2+L2.*m2.*r2.*2.0+L1.*m2.*r2.*cos(th2)))./(lz1.*lz2-L1.^2.*L2.^2.*m2.^2-L1.^2.*lz2.*m1+L1.^2.*lz2.*m2-L2.^2.*lz1.*m2+L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.*m2.^2.*r2.*2.0-L1.^2.*m2.^2.*r2.^2.*cos(th2).^2+L1.*lz2.*m1.*r1.*2.0+L2.*lz1.*m2.*r2.*2.0-L1.*L2.^2.*m1.*m2.*r1.*2.0-L1.^2.*L2.*m1.*m2.*r2.*2.0+L1.*L2.*m1.*m2.*r1.*r2.*4.0)+((tau1-g.*(m1.*r1.*cos(th1)+m2.*r2.*cos(th1+th2)+L1.*m2.*cos(th1))+L1.*dth2.*m2.*r2.*sin(th2).*(dth1.*2.0+dth2)).*(lz2-L2.^2.*m2+L2.*m2.*r2.*2.0))./(lz1.*lz2-L1.^2.*L2.^2.*m2.^2-L1.^2.*lz2.*m1+L1.^2.*lz2.*m2-L2.^2.*lz1.*m2+L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.*m2.^2.*r2.*2.0-L1.^2.*m2.^2.*r2.^2.*cos(th2).^2+L1.*lz2.*m1.*r1.*2.0+L2.*lz1.*m2.*r2.*2.0-L1.*L2.^2.*m1.*m2.*r1.*2.0-L1.^2.*L2.*m1.*m2.*r2.*2.0+L1.*L2.*m1.*m2.*r1.*r2.*4.0);dth2;-((-tau2+g.*m2.*r2.*cos(th1+th2)+L1.*dth1.^2.*m2.*r2.*sin(th2)).*(lz1+lz2-L1.^2.*m1+L1.^2.*m2-L2.^2.*m2+L1.*m1.*r1.*2.0+L2.*m2.*r2.*2.0+L1.*m2.*r2.*cos(th2).*2.0))./(lz1.*lz2-L1.^2.*L2.^2.*m2.^2-L1.^2.*lz2.*m1+L1.^2.*lz2.*m2-L2.^2.*lz1.*m2+L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.*m2.^2.*r2.*2.0-L1.^2.*m2.^2.*r2.^2.*cos(th2).^2+L1.*lz2.*m1.*r1.*2.0+L2.*lz1.*m2.*r2.*2.0-L1.*L2.^2.*m1.*m2.*r1.*2.0-L1.^2.*L2.*m1.*m2.*r2.*2.0+L1.*L2.*m1.*m2.*r1.*r2.*4.0)-((tau1-g.*(m1.*r1.*cos(th1)+m2.*r2.*cos(th1+th2)+L1.*m2.*cos(th1))+L1.*dth2.*m2.*r2.*sin(th2).*(dth1.*2.0+dth2)).*(lz2-L2.^2.*m2+L2.*m2.*r2.*2.0+L1.*m2.*r2.*cos(th2)))./(lz1.*lz2-L1.^2.*L2.^2.*m2.^2-L1.^2.*lz2.*m1+L1.^2.*lz2.*m2-L2.^2.*lz1.*m2+L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.*m2.^2.*r2.*2.0-L1.^2.*m2.^2.*r2.^2.*cos(th2).^2+L1.*lz2.*m1.*r1.*2.0+L2.*lz1.*m2.*r2.*2.0-L1.*L2.^2.*m1.*m2.*r1.*2.0-L1.^2.*L2.*m1.*m2.*r2.*2.0+L1.*L2.*m1.*m2.*r1.*r2.*4.0)];
